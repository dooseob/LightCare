<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head th:replace="~{layout/header :: header}">
    <title>관리자 대시보드 - CareLink</title>
</head>
<body class="d-flex flex-column min-vh-100 pt-5">
<nav th:replace="~{layout/header :: navbar}"></nav>

<div th:replace="~{layout/header :: messages}"></div>

<main class="flex-grow-1">
    <div class="container mt-4">
        <!-- 브레드크럼 -->
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/">홈</a></li>
                <li class="breadcrumb-item active" aria-current="page">관리자 대시보드</li>
            </ol>
        </nav>

        <!-- 페이지 헤더 -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="d-flex align-items-center justify-content-between">
                    <div>
                        <h1 class="h2 mb-1">
                            <i class="fas fa-tachometer-alt text-primary me-2"></i>
                            관리자 대시보드
                        </h1>
                        <p class="text-muted mb-0">CareLink 전체 시스템을 관리할 수 있습니다.</p>
                    </div>
                    <div>
                        <span class="badge bg-success fs-6">
                            <i class="fas fa-crown me-1"></i>Administrator
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 통계 카드 -->
        <div class="row g-4 mb-5">
            <!-- 승인 대기 시설 -->
            <div class="col-md-6 col-lg-3">
                <div class="card border-warning h-100">
                    <div class="card-body text-center">
                        <div class="display-6 text-warning mb-2">
                            <i class="fas fa-clock"></i>
                        </div>
                        <h5 class="card-title">승인 대기</h5>
                        <h2 class="text-warning mb-2" th:text="${pendingFacilities}">0</h2>
                        <p class="card-text text-muted">시설 승인 대기</p>
                        <a href="/admin/facilities?status=PENDING" class="btn btn-outline-warning btn-sm">
                            <i class="fas fa-eye me-1"></i>확인하기
                        </a>
                    </div>
                </div>
            </div>

            <!-- 전체 회원 -->
            <div class="col-md-6 col-lg-3">
                <div class="card border-primary h-100">
                    <div class="card-body text-center">
                        <div class="display-6 text-primary mb-2">
                            <i class="fas fa-users"></i>
                        </div>
                        <h5 class="card-title">전체 회원</h5>
                        <h2 class="text-primary mb-2" th:text="${totalMembers}">0</h2>
                        <p class="card-text text-muted">등록된 회원 수</p>
                        <a href="/admin/members" class="btn btn-outline-primary btn-sm">
                            <i class="fas fa-list me-1"></i>관리하기
                        </a>
                    </div>
                </div>
            </div>

            <!-- 시설 회원 -->
            <div class="col-md-6 col-lg-3">
                <div class="card border-success h-100">
                    <div class="card-body text-center">
                        <div class="display-6 text-success mb-2">
                            <i class="fas fa-building"></i>
                        </div>
                        <h5 class="card-title">시설 회원</h5>
                        <h2 class="text-success mb-2" th:text="${facilityMembers}">0</h2>
                        <p class="card-text text-muted">시설 운영자</p>
                        <a href="/admin/members?role=FACILITY" class="btn btn-outline-success btn-sm">
                            <i class="fas fa-search me-1"></i>조회하기
                        </a>
                    </div>
                </div>
            </div>

            <!-- 일반 회원 -->
            <div class="col-md-6 col-lg-3">
                <div class="card border-info h-100">
                    <div class="card-body text-center">
                        <div class="display-6 text-info mb-2">
                            <i class="fas fa-user"></i>
                        </div>
                        <h5 class="card-title">일반 회원</h5>
                        <h2 class="text-info mb-2" th:text="${userMembers}">0</h2>
                        <p class="card-text text-muted">구직자 및 가족</p>
                        <a href="/admin/members?role=USER" class="btn btn-outline-info btn-sm">
                            <i class="fas fa-search me-1"></i>조회하기
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- 주요 관리 메뉴 -->
        <div class="row g-4 mb-5">
            <div class="col-12">
                <h3 class="mb-3">
                    <i class="fas fa-cogs text-secondary me-2"></i>
                    주요 관리 기능
                </h3>
            </div>

            <!-- 시설 승인 관리 -->
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-warning bg-opacity-10 p-3 rounded-circle me-3">
                                <i class="fas fa-check-circle text-warning fa-lg"></i>
                            </div>
                            <div>
                                <h5 class="card-title mb-1">시설 승인 관리</h5>
                                <p class="card-text text-muted small mb-0">신규 시설 등록 승인</p>
                            </div>
                        </div>
                        <div class="d-grid gap-2">
                            <a href="/admin/facilities?status=PENDING" class="btn btn-warning">
                                <i class="fas fa-clock me-1"></i>승인 대기 (<span th:text="${pendingFacilities}">0</span>)
                            </a>
                            <a href="/admin/facilities?status=APPROVED" class="btn btn-outline-success btn-sm">
                                <i class="fas fa-check me-1"></i>승인 완료
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 회원 관리 -->
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-primary bg-opacity-10 p-3 rounded-circle me-3">
                                <i class="fas fa-users text-primary fa-lg"></i>
                            </div>
                            <div>
                                <h5 class="card-title mb-1">회원 관리</h5>
                                <p class="card-text text-muted small mb-0">전체 회원 현황 및 관리</p>
                            </div>
                        </div>
                        <div class="d-grid gap-2">
                            <a href="/admin/members" class="btn btn-primary">
                                <i class="fas fa-list me-1"></i>전체 회원 (<span th:text="${totalMembers}">0</span>)
                            </a>
                            <a href="/admin/members?role=FACILITY" class="btn btn-outline-success btn-sm">
                                <i class="fas fa-building me-1"></i>시설 회원
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 통계 및 분석 -->
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-info bg-opacity-10 p-3 rounded-circle me-3">
                                <i class="fas fa-chart-bar text-info fa-lg"></i>
                            </div>
                            <div>
                                <h5 class="card-title mb-1">통계 및 분석</h5>
                                <p class="card-text text-muted small mb-0">시스템 현황 분석</p>
                            </div>
                        </div>
                        <div class="d-grid gap-2">
                            <a href="/admin/statistics" class="btn btn-info">
                                <i class="fas fa-chart-line me-1"></i>상세 통계 보기
                            </a>
                            <button class="btn btn-outline-info btn-sm" onclick="refreshStats()">
                                <i class="fas fa-sync me-1"></i>데이터 새로고침
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 빠른 접근 링크 -->
        <div class="row mb-4">
            <div class="col-12">
                <h4 class="mb-3">
                    <i class="fas fa-bolt text-warning me-2"></i>
                    빠른 접근
                </h4>
                <div class="btn-group" role="group">
                    <a href="/admin/facilities" class="btn btn-outline-secondary">
                        <i class="fas fa-building me-1"></i>시설 관리
                    </a>
                    <a href="/admin/members" class="btn btn-outline-secondary">
                        <i class="fas fa-users me-1"></i>회원 관리
                    </a>
                    <a href="/board" class="btn btn-outline-secondary">
                        <i class="fas fa-clipboard-list me-1"></i>게시판 관리
                    </a>
                    <a href="/review" class="btn btn-outline-secondary">
                        <i class="fas fa-star me-1"></i>리뷰 관리
                    </a>
                </div>
            </div>
        </div>
    </div>
</main>

<footer th:replace="~{layout/footer :: footer}"></footer>

<div th:replace="~{layout/footer :: scripts}"></div>

<script>
// 데이터 새로고침 함수
function refreshStats() {
    location.reload();
}

// 페이지 로드 시 통계 업데이트
$(document).ready(function() {
    console.log('관리자 대시보드 로드 완료');
    
    // 승인 대기 시설이 있으면 강조
    const pendingCount = parseInt($('[th\\:text="${pendingFacilities}"]').text());
    if (pendingCount > 0) {
        console.log('승인 대기 시설:', pendingCount);
    }
});
</script>

</body>
</html>